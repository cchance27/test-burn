We fixed v5 M=1 kernels, but we just realized all our non-m=1 kernels are broken we will need to resolve

Matmul benchmark summary (iterations=6)
Spec op=matmul | batch=1 | m=1 | n=9728 | k=896 | tA=0 | tB=1:
   - mlx/baseline: avg_gpu=0.485ms | avg_cpu=0.72ms [vs orig 0.325ms] (+121.55%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - mlx/bk64_nt: avg_gpu=0.432ms | avg_cpu=0.669ms [vs orig 0.325ms] (+105.84%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - mlx/m1_fast_nt: avg_gpu=0.316ms | avg_cpu=0.504ms [vs orig 0.325ms] (+55.13%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col: avg_gpu=0.342ms | avg_cpu=0.528ms [vs orig 0.325ms] (+62.43%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_bk128_tg128: avg_gpu=0.187ms | avg_cpu=0.38ms [vs orig 0.325ms] (+16.90%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg128: avg_gpu=0.187ms | avg_cpu=0.378ms [vs orig 0.325ms] (+16.18%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg64: avg_gpu=0.252ms | avg_cpu=0.438ms [vs orig 0.325ms] (+34.72%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128: avg_gpu=0.17ms | avg_cpu=0.342ms [vs orig 0.325ms] (+5.20%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128: avg_gpu=0.171ms | avg_cpu=0.365ms [vs orig 0.325ms] (+12.43%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col: avg_gpu=0.366ms | avg_cpu=0.807ms [vs orig 0.325ms] (+148.22%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_bk128_tg128: avg_gpu=0.18ms | avg_cpu=0.373ms [vs orig 0.325ms] (+14.68%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg128: avg_gpu=0.157ms | avg_cpu=0.392ms [vs orig 0.325ms] (+20.66%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg64: avg_gpu=0.175ms | avg_cpu=0.374ms [vs orig 0.325ms] (+15.10%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128 [best-gpu]: avg_gpu=0.139ms | avg_cpu=0.315ms [vs orig 0.325ms] (-3.22%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128: avg_gpu=0.167ms | avg_cpu=0.508ms [vs orig 0.325ms] (+56.36%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v3/nt_bn128_col_vec4_sgbr_bk64_tg128: avg_gpu=0.146ms | avg_cpu=0.328ms [vs orig 0.325ms] (+1.06%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v3/nt_bn128_col_vec4_tgread_bk128_tg128: avg_gpu=0.172ms | avg_cpu=0.361ms [vs orig 0.325ms] (+11.11%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v3/nt_bn128_col_vec4_tgread_bk64_tg128: avg_gpu=0.17ms | avg_cpu=0.365ms [vs orig 0.325ms] (+12.21%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v3/nt_bn64_col_vec4_tgread_bk128_tg128: avg_gpu=0.166ms | avg_cpu=0.357ms [vs orig 0.325ms] (+9.87%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v4/nt_bn256_col_vec4_tgread_bk128_tg128: avg_gpu=0.192ms | avg_cpu=0.467ms [vs orig 0.325ms] (+43.61%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v4/nt_bn256_col_vec4_tgread_bk64_tg128: avg_gpu=0.206ms | avg_cpu=0.444ms [vs orig 0.325ms] (+36.62%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v4/nt_tiny_bn32_tg64: avg_gpu=0.163ms | avg_cpu=0.327ms [vs orig 0.325ms] (+0.50%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v4/nt_tiny_bn64_tg64: avg_gpu=0.168ms | avg_cpu=0.59ms [vs orig 0.325ms] (+81.53%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - mps/baseline [baseline] [best-cpu]: avg_gpu=0.162ms | avg_cpu=0.295ms [vs orig 0.325ms] (-9.17%) maxAbs=1.5522e-02 maxRel=4.7867e-04
Spec op=matmul | batch=1 | m=1 | n=896 | k=4864 | tA=0 | tB=1:
   - mlx/baseline: avg_gpu=0.662ms | avg_cpu=0.897ms [vs orig 0.239ms] (+275.35%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - mlx/bk64_nt: avg_gpu=0.396ms | avg_cpu=0.62ms [vs orig 0.239ms] (+159.59%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - mlx/m1_fast_nt: avg_gpu=0.216ms | avg_cpu=0.398ms [vs orig 0.239ms] (+66.58%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col: avg_gpu=1.155ms | avg_cpu=1.439ms [vs orig 0.239ms] (+501.99%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_bk128_tg128: avg_gpu=0.548ms | avg_cpu=0.773ms [vs orig 0.239ms] (+223.43%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg128: avg_gpu=0.588ms | avg_cpu=0.953ms [vs orig 0.239ms] (+298.60%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg64: avg_gpu=0.848ms | avg_cpu=1.016ms [vs orig 0.239ms] (+325.31%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128: avg_gpu=0.378ms | avg_cpu=0.683ms [vs orig 0.239ms] (+185.92%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128: avg_gpu=0.448ms | avg_cpu=0.651ms [vs orig 0.239ms] (+172.22%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col: avg_gpu=1.128ms | avg_cpu=1.344ms [vs orig 0.239ms] (+462.24%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_bk128_tg128: avg_gpu=0.519ms | avg_cpu=0.763ms [vs orig 0.239ms] (+219.15%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg128: avg_gpu=0.972ms | avg_cpu=1.25ms [vs orig 0.239ms] (+422.94%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg64: avg_gpu=0.603ms | avg_cpu=0.836ms [vs orig 0.239ms] (+249.63%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128: avg_gpu=0.388ms | avg_cpu=0.646ms [vs orig 0.239ms] (+170.31%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128: avg_gpu=0.415ms | avg_cpu=0.586ms [vs orig 0.239ms] (+145.05%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v3/nt_bn128_col_vec4_sgbr_bk64_tg128: avg_gpu=0.436ms | avg_cpu=0.661ms [vs orig 0.239ms] (+176.74%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v3/nt_bn128_col_vec4_tgread_bk128_tg128: avg_gpu=0.371ms | avg_cpu=0.569ms [vs orig 0.239ms] (+138.18%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v3/nt_bn128_col_vec4_tgread_bk64_tg128: avg_gpu=0.414ms | avg_cpu=0.655ms [vs orig 0.239ms] (+174.03%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v3/nt_bn64_col_vec4_tgread_bk128_tg128: avg_gpu=0.359ms | avg_cpu=0.582ms [vs orig 0.239ms] (+143.52%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v4/nt_bn16_largek_smalln_tg256: avg_gpu=0.245ms | avg_cpu=0.448ms [vs orig 0.239ms] (+87.35%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v4/nt_bn4_largek_smalln_tg256: avg_gpu=0.13ms | avg_cpu=0.448ms [vs orig 0.239ms] (+87.56%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v4/nt_bn8_largek_smalln_tg128: avg_gpu=0.237ms | avg_cpu=0.702ms [vs orig 0.239ms] (+193.73%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v4/nt_bn8_largek_smalln_tg256: avg_gpu=0.131ms | avg_cpu=0.311ms [vs orig 0.239ms] (+29.99%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v4/nt_tiny_bn32_tg64: avg_gpu=0.31ms | avg_cpu=0.531ms [vs orig 0.239ms] (+122.33%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v4/nt_tiny_bn64_tg64: avg_gpu=0.305ms | avg_cpu=0.555ms [vs orig 0.239ms] (+132.19%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v5/nt_bn16_largek_smalln_tg256: avg_gpu=0.262ms | avg_cpu=0.616ms [vs orig 0.239ms] (+157.54%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v5/nt_bn16_largek_smalln_tg512: avg_gpu=0.18ms | avg_cpu=0.372ms [vs orig 0.239ms] (+55.45%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v5/nt_bn4_largek_smalln_tg256 [best-gpu] [best-cpu]: avg_gpu=0.066ms | avg_cpu=0.242ms [vs orig 0.239ms] (+1.36%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v5/nt_bn4_largek_smalln_tg512: avg_gpu=0.135ms | avg_cpu=0.425ms [vs orig 0.239ms] (+77.82%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v5/nt_bn8_largek_smalln_tg256: avg_gpu=0.14ms | avg_cpu=0.307ms [vs orig 0.239ms] (+28.38%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v5/nt_bn8_largek_smalln_tg512: avg_gpu=0.154ms | avg_cpu=0.345ms [vs orig 0.239ms] (+44.51%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - mps/baseline [baseline]: avg_gpu=0.084ms | avg_cpu=0.365ms [vs orig 0.239ms] (+52.73%) maxAbs=2.8069e-02 maxRel=4.5125e-04
Spec op=matmul | batch=1 | m=1 | n=896 | k=896 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.128ms | avg_cpu=0.314ms [vs orig 0.235ms] (+33.41%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - mlx/bk64_nt: avg_gpu=0.08ms | avg_cpu=0.301ms [vs orig 0.235ms] (+28.28%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - mlx/m1_fast_nt: avg_gpu=0.092ms | avg_cpu=0.289ms [vs orig 0.235ms] (+22.81%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col: avg_gpu=0.279ms | avg_cpu=0.477ms [vs orig 0.235ms] (+103.18%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_bk128_tg128: avg_gpu=0.106ms | avg_cpu=0.336ms [vs orig 0.235ms] (+42.92%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg128: avg_gpu=0.113ms | avg_cpu=0.453ms [vs orig 0.235ms] (+92.87%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg64: avg_gpu=0.208ms | avg_cpu=0.407ms [vs orig 0.235ms] (+73.02%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128: avg_gpu=0.077ms | avg_cpu=0.448ms [vs orig 0.235ms] (+90.44%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128: avg_gpu=0.08ms | avg_cpu=0.284ms [vs orig 0.235ms] (+20.93%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col: avg_gpu=0.276ms | avg_cpu=0.486ms [vs orig 0.235ms] (+106.73%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_bk128_tg128: avg_gpu=0.106ms | avg_cpu=0.327ms [vs orig 0.235ms] (+39.01%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg128: avg_gpu=0.11ms | avg_cpu=0.294ms [vs orig 0.235ms] (+25.17%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg64: avg_gpu=0.11ms | avg_cpu=0.335ms [vs orig 0.235ms] (+42.63%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128: avg_gpu=0.073ms | avg_cpu=0.283ms [vs orig 0.235ms] (+20.58%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128 [best-cpu]: avg_gpu=0.069ms | avg_cpu=0.204ms [vs orig 0.235ms] (-13.20%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v3/nt_bn128_col_vec4_sgbr_bk64_tg128: avg_gpu=0.088ms | avg_cpu=0.237ms [vs orig 0.235ms] (+1.03%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v3/nt_bn128_col_vec4_tgread_bk128_tg128: avg_gpu=0.075ms | avg_cpu=0.251ms [vs orig 0.235ms] (+6.91%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v3/nt_bn128_col_vec4_tgread_bk64_tg128: avg_gpu=0.082ms | avg_cpu=0.292ms [vs orig 0.235ms] (+24.39%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v3/nt_bn64_col_vec4_tgread_bk128_tg128: avg_gpu=0.072ms | avg_cpu=0.263ms [vs orig 0.235ms] (+11.78%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v4/nt_tiny_bn32_tg64: avg_gpu=0.061ms | avg_cpu=0.411ms [vs orig 0.235ms] (+74.72%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v4/nt_tiny_bn64_tg64: avg_gpu=0.062ms | avg_cpu=0.398ms [vs orig 0.235ms] (+69.50%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v5/nt_ultra_tiny_single_tg32: avg_gpu=1.09ms | avg_cpu=1.359ms [vs orig 0.235ms] (+478.18%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - mps/baseline [best-gpu]: avg_gpu=0.025ms | avg_cpu=0.425ms [vs orig 0.235ms] (+81.04%) maxAbs=8.7585e-03 maxRel=4.7132e-04
Spec op=matmul_bias_add | batch=1 | m=1 | n=1152 | k=896 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.135ms | avg_cpu=0.329ms [vs orig 0.234ms] (+40.75%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/bk64_nn: avg_gpu=0.128ms | avg_cpu=0.364ms [vs orig 0.234ms] (+55.39%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/m1_fast_nn [best-cpu]: avg_gpu=0.085ms | avg_cpu=0.202ms [vs orig 0.234ms] (-13.85%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/nn_fast: avg_gpu=0.118ms | avg_cpu=0.35ms [vs orig 0.234ms] (+49.74%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/nn_wide: avg_gpu=0.122ms | avg_cpu=0.264ms [vs orig 0.234ms] (+12.97%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - m1_optimized/simd_basic: avg_gpu=1.131ms | avg_cpu=1.289ms [vs orig 0.234ms] (+451.02%) maxAbs=3.4028e+38 maxRel=1.9983e+00
   - m1_optimized/simd_tiled_1: avg_gpu=1.154ms | avg_cpu=1.377ms [vs orig 0.234ms] (+488.45%) maxAbs=3.6164e+01 maxRel=1.8316e+00
   - m1_optimized/simd_tiled_2: avg_gpu=1.188ms | avg_cpu=1.422ms [vs orig 0.234ms] (+507.58%) maxAbs=3.6164e+01 maxRel=1.8316e+00
   - m1_optimized/simd_tiled_4: avg_gpu=1.173ms | avg_cpu=1.384ms [vs orig 0.234ms] (+491.25%) maxAbs=3.6164e+01 maxRel=1.8316e+00
   - mps/baseline: avg_gpu=0.034ms | avg_cpu=0.301ms [vs orig 0.234ms] (+28.82%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - gemv/baseline: avg_gpu=0.343ms | avg_cpu=0.538ms [vs orig 0.234ms] (+129.81%) maxAbs=3.2752e+04 maxRel=1.9980e+00
   - gemm_tiled/baseline [best-gpu]: avg_gpu=0.012ms | avg_cpu=0.232ms [vs orig 0.234ms] (-0.71%) maxAbs=3.6164e+01 maxRel=1.8316e+00
Spec op=matmul | batch=1 | m=1 | n=151936 | k=896 | tA=0 | tB=1:
   - mlx/baseline: avg_gpu=2.133ms | avg_cpu=2.317ms [vs orig 2.51ms] (-7.67%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - mlx/bk64_nt: avg_gpu=2.062ms | avg_cpu=2.258ms [vs orig 2.51ms] (-10.03%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - mlx/m1_fast_nt: avg_gpu=2.095ms | avg_cpu=2.296ms [vs orig 2.51ms] (-8.51%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col: avg_gpu=2.278ms | avg_cpu=2.484ms [vs orig 2.51ms] (-1.03%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_bk128_tg128: avg_gpu=2.1ms | avg_cpu=2.242ms [vs orig 2.51ms] (-10.66%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg128: avg_gpu=2.799ms | avg_cpu=3.028ms [vs orig 2.51ms] (+20.63%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg64: avg_gpu=2.211ms | avg_cpu=2.426ms [vs orig 2.51ms] (-3.35%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128: avg_gpu=2.836ms | avg_cpu=3.109ms [vs orig 2.51ms] (+23.86%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128: avg_gpu=2.047ms | avg_cpu=2.247ms [vs orig 2.51ms] (-10.47%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col: avg_gpu=2.031ms | avg_cpu=2.235ms [vs orig 2.51ms] (-10.95%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_bk128_tg128: avg_gpu=2.038ms | avg_cpu=2.242ms [vs orig 2.51ms] (-10.66%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg128 [best-gpu] [best-cpu]: avg_gpu=2.019ms | avg_cpu=2.201ms [vs orig 2.51ms] (-12.31%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg64: avg_gpu=2.081ms | avg_cpu=2.283ms [vs orig 2.51ms] (-9.06%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128: avg_gpu=2.175ms | avg_cpu=2.482ms [vs orig 2.51ms] (-1.13%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128: avg_gpu=2.115ms | avg_cpu=2.276ms [vs orig 2.51ms] (-9.31%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v3/nt_bn128_col_vec4_sgbr_bk64_tg128: avg_gpu=2.051ms | avg_cpu=2.253ms [vs orig 2.51ms] (-10.23%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v3/nt_bn128_col_vec4_tgread_bk128_tg128: avg_gpu=2.046ms | avg_cpu=2.26ms [vs orig 2.51ms] (-9.95%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v3/nt_bn128_col_vec4_tgread_bk64_tg128: avg_gpu=2.155ms | avg_cpu=2.296ms [vs orig 2.51ms] (-8.53%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v3/nt_bn64_col_vec4_tgread_bk128_tg128: avg_gpu=2.061ms | avg_cpu=2.277ms [vs orig 2.51ms] (-9.28%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v4/nt_bn256_col_vec4_tgread_bk128_tg128: avg_gpu=2.237ms | avg_cpu=2.445ms [vs orig 2.51ms] (-2.58%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v4/nt_bn256_col_vec4_tgread_bk64_tg128: avg_gpu=2.656ms | avg_cpu=2.973ms [vs orig 2.51ms] (+18.44%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v4/nt_tiny_bn32_tg64: avg_gpu=2.038ms | avg_cpu=2.236ms [vs orig 2.51ms] (-10.93%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v4/nt_tiny_bn64_tg64: avg_gpu=2.103ms | avg_cpu=2.305ms [vs orig 2.51ms] (-8.19%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - mps/baseline [baseline]: avg_gpu=2.193ms | avg_cpu=2.61ms [vs orig 2.51ms] (+3.97%) maxAbs=1.5606e-02 maxRel=4.8769e-04
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=95 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.033ms | avg_cpu=0.201ms [vs orig 0.25ms] (-19.66%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/bk64_nn: avg_gpu=0.024ms | avg_cpu=0.183ms [vs orig 0.25ms] (-26.71%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/m1_fast_nn: avg_gpu=0.03ms | avg_cpu=0.3ms [vs orig 0.25ms] (+20.07%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/nn_fast: avg_gpu=0.028ms | avg_cpu=0.293ms [vs orig 0.25ms] (+17.34%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/nn_wide: avg_gpu=0.037ms | avg_cpu=0.2ms [vs orig 0.25ms] (-19.99%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mps/baseline [best-gpu]: avg_gpu=0.012ms | avg_cpu=0.325ms [vs orig 0.25ms] (+29.95%) maxAbs=1.2707e+01 maxRel=1.9899e+00
   - gemm_tiled/baseline [best-cpu] [host-gap]: avg_gpu=0.015ms | avg_cpu=0.171ms [vs orig 0.25ms] (-31.49%) maxAbs=1.2707e+01 maxRel=1.9899e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=16 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline] [host-gap]: avg_gpu=0.016ms | avg_cpu=0.172ms [vs orig 0.249ms] (-30.74%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/bk64_nn [host-gap]: avg_gpu=0.018ms | avg_cpu=0.149ms [vs orig 0.249ms] (-40.14%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/m1_fast_nn: avg_gpu=0.346ms | avg_cpu=0.633ms [vs orig 0.249ms] (+154.34%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/nn_fast: avg_gpu=0.017ms | avg_cpu=0.284ms [vs orig 0.249ms] (+14.13%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/nn_wide [host-gap]: avg_gpu=0.022ms | avg_cpu=0.185ms [vs orig 0.249ms] (-25.61%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mps/baseline [best-gpu]: avg_gpu=0.015ms | avg_cpu=0.373ms [vs orig 0.249ms] (+49.85%) maxAbs=5.3670e+00 maxRel=1.9424e+00
   - gemm_tiled/baseline [best-cpu] [host-gap]: avg_gpu=0.017ms | avg_cpu=0.129ms [vs orig 0.249ms] (-48.11%) maxAbs=5.3670e+00 maxRel=1.9424e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=51 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.007ms | avg_cpu=0.371ms [vs orig 0.231ms] (+60.47%) maxAbs=1.2858e+01 maxRel=1.9744e+00
   - mlx/bk64_nt: avg_gpu=0.007ms | avg_cpu=0.359ms [vs orig 0.231ms] (+55.52%) maxAbs=1.2858e+01 maxRel=1.9744e+00
   - mlx/m1_fast_nt [best-gpu]: avg_gpu=0.006ms | avg_cpu=0.36ms [vs orig 0.231ms] (+55.73%) maxAbs=3.1772e+03 maxRel=1.9744e+00
   - mps/baseline [best-cpu]: avg_gpu=0.022ms | avg_cpu=0.214ms [vs orig 0.231ms] (-7.23%) maxAbs=1.0837e+01 maxRel=1.9621e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=88 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.036ms | avg_cpu=0.198ms [vs orig 0.219ms] (-9.68%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/bk64_nn [best-cpu]: avg_gpu=0.027ms | avg_cpu=0.164ms [vs orig 0.219ms] (-25.28%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/m1_fast_nn: avg_gpu=0.368ms | avg_cpu=0.529ms [vs orig 0.219ms] (+141.57%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/nn_fast: avg_gpu=0.031ms | avg_cpu=0.333ms [vs orig 0.219ms] (+52.07%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/nn_wide: avg_gpu=0.038ms | avg_cpu=0.406ms [vs orig 0.219ms] (+85.48%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mps/baseline [best-gpu]: avg_gpu=0.012ms | avg_cpu=0.371ms [vs orig 0.219ms] (+69.20%) maxAbs=1.0712e+01 maxRel=1.8953e+00
   - gemm_tiled/baseline [host-gap]: avg_gpu=0.017ms | avg_cpu=0.215ms [vs orig 0.219ms] (-1.82%) maxAbs=1.0712e+01 maxRel=1.8953e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=83 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline] [best-gpu]: avg_gpu=0.007ms | avg_cpu=0.38ms [vs orig 0.216ms] (+75.84%) maxAbs=1.0957e+01 maxRel=1.9983e+00
   - mlx/bk64_nt: avg_gpu=0.01ms | avg_cpu=0.425ms [vs orig 0.216ms] (+96.70%) maxAbs=1.0957e+01 maxRel=1.9983e+00
   - mlx/m1_fast_nt: avg_gpu=0.008ms | avg_cpu=0.362ms [vs orig 0.216ms] (+67.69%) maxAbs=1.0957e+01 maxRel=1.9983e+00
   - mps/baseline [best-cpu]: avg_gpu=0.17ms | avg_cpu=0.336ms [vs orig 0.216ms] (+55.60%) maxAbs=8.5818e+00 maxRel=1.9616e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=90 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.007ms | avg_cpu=0.383ms [vs orig 0.208ms] (+84.37%) maxAbs=1.2589e+01 maxRel=1.9927e+00
   - mlx/bk64_nt [best-gpu]: avg_gpu=0.006ms | avg_cpu=0.386ms [vs orig 0.208ms] (+85.55%) maxAbs=1.2589e+01 maxRel=1.9927e+00
   - mlx/m1_fast_nt: avg_gpu=0.007ms | avg_cpu=0.408ms [vs orig 0.208ms] (+96.29%) maxAbs=1.2589e+01 maxRel=1.9927e+00
   - mps/baseline [best-cpu] [host-gap]: avg_gpu=0.014ms | avg_cpu=0.222ms [vs orig 0.208ms] (+6.59%) maxAbs=8.6755e+00 maxRel=1.9529e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=76 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline] [best-gpu]: avg_gpu=0.007ms | avg_cpu=0.384ms [vs orig 0.208ms] (+84.69%) maxAbs=9.8521e+00 maxRel=1.9938e+00
   - mlx/bk64_nt: avg_gpu=0.007ms | avg_cpu=0.409ms [vs orig 0.208ms] (+96.44%) maxAbs=9.8521e+00 maxRel=1.9938e+00
   - mlx/m1_fast_nt: avg_gpu=0.012ms | avg_cpu=0.428ms [vs orig 0.208ms] (+105.82%) maxAbs=9.8521e+00 maxRel=1.9938e+00
   - mps/baseline [best-cpu]: avg_gpu=0.03ms | avg_cpu=0.204ms [vs orig 0.208ms] (-1.98%) maxAbs=9.7824e+00 maxRel=1.8962e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=83 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.035ms | avg_cpu=0.265ms [vs orig 0.187ms] (+41.57%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/bk64_nn: avg_gpu=0.252ms | avg_cpu=0.532ms [vs orig 0.187ms] (+184.75%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/m1_fast_nn [best-gpu] [best-cpu]: avg_gpu=0.017ms | avg_cpu=0.145ms [vs orig 0.187ms] (-22.27%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/nn_fast: avg_gpu=0.031ms | avg_cpu=0.386ms [vs orig 0.187ms] (+106.46%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/nn_wide: avg_gpu=0.039ms | avg_cpu=0.389ms [vs orig 0.187ms] (+108.03%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mps/baseline: avg_gpu=0.025ms | avg_cpu=0.206ms [vs orig 0.187ms] (+10.17%) maxAbs=1.0758e+01 maxRel=1.9301e+00
   - gemm_tiled/baseline: avg_gpu=0.026ms | avg_cpu=0.208ms [vs orig 0.187ms] (+11.33%) maxAbs=1.0758e+01 maxRel=1.9301e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=69 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.036ms | avg_cpu=0.198ms [vs orig 0.176ms] (+12.46%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/bk64_nn: avg_gpu=0.028ms | avg_cpu=0.151ms [vs orig 0.176ms] (-14.48%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/m1_fast_nn [best-cpu]: avg_gpu=0.018ms | avg_cpu=0.149ms [vs orig 0.176ms] (-15.41%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/nn_fast: avg_gpu=0.031ms | avg_cpu=0.366ms [vs orig 0.176ms] (+107.76%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/nn_wide: avg_gpu=0.043ms | avg_cpu=0.413ms [vs orig 0.176ms] (+134.38%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mps/baseline [best-gpu]: avg_gpu=0.012ms | avg_cpu=0.169ms [vs orig 0.176ms] (-4.26%) maxAbs=8.0584e+00 maxRel=1.8970e+00
   - gemm_tiled/baseline: avg_gpu=0.029ms | avg_cpu=0.224ms [vs orig 0.176ms] (+27.35%) maxAbs=9.2600e+00 maxRel=1.8970e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=80 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.009ms | avg_cpu=0.421ms [vs orig 0.176ms] (+139.30%) maxAbs=1.4338e+01 maxRel=1.9998e+00
   - mlx/bk64_nt [best-gpu]: avg_gpu=0.007ms | avg_cpu=0.402ms [vs orig 0.176ms] (+128.67%) maxAbs=1.4338e+01 maxRel=1.9998e+00
   - mlx/m1_fast_nt: avg_gpu=0.009ms | avg_cpu=0.385ms [vs orig 0.176ms] (+118.94%) maxAbs=1.4338e+01 maxRel=1.9998e+00
   - mps/baseline [best-cpu] [host-gap]: avg_gpu=0.01ms | avg_cpu=0.156ms [vs orig 0.176ms] (-11.57%) maxAbs=8.5940e+00 maxRel=1.9854e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=67 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.008ms | avg_cpu=0.419ms [vs orig 0.172ms] (+143.71%) maxAbs=1.1647e+01 maxRel=1.9918e+00
   - mlx/bk64_nt: avg_gpu=0.009ms | avg_cpu=0.401ms [vs orig 0.172ms] (+133.22%) maxAbs=1.1647e+01 maxRel=1.9918e+00
   - mlx/m1_fast_nt [best-gpu] [best-cpu]: avg_gpu=0.006ms | avg_cpu=0.159ms [vs orig 0.172ms] (-7.75%) maxAbs=1.1647e+01 maxRel=1.9918e+00
   - mps/baseline: avg_gpu=0.011ms | avg_cpu=0.169ms [vs orig 0.172ms] (-1.94%) maxAbs=7.8347e+00 maxRel=1.9760e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=67 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.034ms | avg_cpu=0.2ms [vs orig 0.172ms] (+16.35%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/bk64_nn [best-cpu]: avg_gpu=0.026ms | avg_cpu=0.146ms [vs orig 0.172ms] (-15.33%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/m1_fast_nn: avg_gpu=0.017ms | avg_cpu=0.162ms [vs orig 0.172ms] (-5.85%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/nn_fast: avg_gpu=0.029ms | avg_cpu=0.193ms [vs orig 0.172ms] (+12.00%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/nn_wide: avg_gpu=0.033ms | avg_cpu=0.2ms [vs orig 0.172ms] (+16.24%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mps/baseline [best-gpu]: avg_gpu=0.011ms | avg_cpu=0.173ms [vs orig 0.172ms] (+0.45%) maxAbs=8.9936e+00 maxRel=1.9166e+00
   - gemm_tiled/baseline: avg_gpu=0.021ms | avg_cpu=0.165ms [vs orig 0.172ms] (-4.09%) maxAbs=8.9936e+00 maxRel=1.9166e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=73 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.008ms | avg_cpu=0.378ms [vs orig 0.172ms] (+119.71%) maxAbs=1.2113e+01 maxRel=1.9921e+00
   - mlx/bk64_nt [best-gpu]: avg_gpu=0.006ms | avg_cpu=0.28ms [vs orig 0.172ms] (+62.86%) maxAbs=1.2113e+01 maxRel=1.9921e+00
   - mlx/m1_fast_nt [best-cpu] [host-gap]: avg_gpu=0.008ms | avg_cpu=0.162ms [vs orig 0.172ms] (-6.05%) maxAbs=1.2113e+01 maxRel=1.9921e+00
   - mps/baseline [host-gap]: avg_gpu=0.011ms | avg_cpu=0.17ms [vs orig 0.172ms] (-1.32%) maxAbs=9.4629e+00 maxRel=1.9091e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=68 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.034ms | avg_cpu=0.301ms [vs orig 0.169ms] (+78.37%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/bk64_nn [best-cpu]: avg_gpu=0.025ms | avg_cpu=0.153ms [vs orig 0.169ms] (-9.49%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/m1_fast_nn: avg_gpu=0.017ms | avg_cpu=0.168ms [vs orig 0.169ms] (-0.59%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/nn_fast: avg_gpu=0.03ms | avg_cpu=0.183ms [vs orig 0.169ms] (+8.42%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/nn_wide: avg_gpu=0.032ms | avg_cpu=0.201ms [vs orig 0.169ms] (+19.01%) maxAbs=3.2834e+01 maxRel=1.9988e+00
   - mps/baseline [best-gpu]: avg_gpu=0.011ms | avg_cpu=0.175ms [vs orig 0.169ms] (+3.39%) maxAbs=9.2023e+00 maxRel=1.8125e+00
   - gemm_tiled/baseline: avg_gpu=0.015ms | avg_cpu=0.163ms [vs orig 0.169ms] (-3.58%) maxAbs=9.2023e+00 maxRel=1.8125e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=84 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.034ms | avg_cpu=0.406ms [vs orig 0.169ms] (+140.14%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/bk64_nn: avg_gpu=0.027ms | avg_cpu=0.211ms [vs orig 0.169ms] (+24.74%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/m1_fast_nn [host-gap]: avg_gpu=0.021ms | avg_cpu=0.154ms [vs orig 0.169ms] (-9.02%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/nn_fast: avg_gpu=0.028ms | avg_cpu=0.164ms [vs orig 0.169ms] (-3.07%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/nn_wide: avg_gpu=0.041ms | avg_cpu=0.285ms [vs orig 0.169ms] (+68.38%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mps/baseline [best-gpu]: avg_gpu=0.012ms | avg_cpu=0.349ms [vs orig 0.169ms] (+106.43%) maxAbs=9.9824e+00 maxRel=1.9386e+00
   - gemm_tiled/baseline [best-cpu] [host-gap]: avg_gpu=0.014ms | avg_cpu=0.129ms [vs orig 0.169ms] (-23.39%) maxAbs=9.9824e+00 maxRel=1.9386e+00