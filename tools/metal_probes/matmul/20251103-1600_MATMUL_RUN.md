V2 BT_ tests still show regression, so we will be disabling them we've made progress, 
but still not as fast as MPS and definitly not as fast as we need to be to make a difference in inference.

2025-11-03 follow-up notes:
- Added `m1_dot_product_v3` (SIMD-group broadcast for staged A + vec4 B streaming) derived from the fastest v2 geometry. No heuristics in harness; each occupancy tuple stays isolated in variant naming.
- Registered four v3 variants (bn128/bn64 × bk128/bk64, tg128) under the new `m1_optimized_v3` backend so we can benchmark broadcast vs. non-broadcast paths side-by-side on hot shapes.
- Left all `_bt_` variants disabled after consistent regressions on the last two runs; they remain in the manifest for targeted experiments but aren’t executed by default.
- Next action once caches are cleared: rerun the enhanced probes to capture baseline numbers for each v3 variant, then compare against v2 vec4 and MPS results before layering in additional ideas (bn256, half8, unroll16, etc.).

rm -rf .build && rm -rf .cache && METAL_RUN=1 ./run_matmul_probes_enhanced.sh
Enhanced variants configuration available, enhanced Swift code will use it
Compiling m1_dot_product_v2.metal → m1_dot_product_v2.metallib
Compiling m1_dot_product.metal → m1_dot_product.metallib
/Volumes/2TB/test-burn/tools/metal_probes/matmul/m1_dot_product.metal:25:15: warning: unused variable 'M' [-Wunused-variable]
    const int M = 1;
              ^
1 warning generated.
Compiling optimized_mlx_bk64.metal → optimized_mlx_bk64.metallib
Compiling optimized_mlx_m1.metal → optimized_mlx_m1.metallib
Compiling optimized_mlx_nn.metal → optimized_mlx_nn.metallib
Compiling original_gemm_tiled.metal → original_gemm_tiled.metallib
/Volumes/2TB/test-burn/tools/metal_probes/matmul/original_gemm_tiled.metal:76:20: warning: unused variable 'simdgroups_m' [-Wunused-variable]
        const uint simdgroups_m = tile_m / simdgroup_m;
                   ^
1 warning generated.
Compiling original_gemv_smalln.metal → original_gemv_smalln.metallib
Compiling original_gemv.metal → original_gemv.metallib
Compiling original_mlx.metal → original_mlx.metallib
Enhanced matmul probe compilation succeeded.
Executing enhanced matmul probe harness...
Processing variant: m1_optimized_v2/nt_bn64_col_bt_bk64_tg64
  Running 4 uncached specs for m1_optimized_v2/nt_bn64_col_bt_bk64_tg64...
    Running: nt_bn64_col_bt_bk64_tg64 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn64_col_bt_bk64_tg64. Total cached: 4
Processing variant: m1_optimized_v2/nt_bn128_col_bt_bk64_tg64
  Running 4 uncached specs for m1_optimized_v2/nt_bn128_col_bt_bk64_tg64...
    Running: nt_bn128_col_bt_bk64_tg64 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn128_col_bt_bk64_tg64. Total cached: 4
Processing variant: mlx/m1_fast_tn
  No supported specs for mlx/m1_fast_tn.
Processing variant: mlx/m1_fast_nn
  Running 9 uncached specs for mlx/m1_fast_nn...
    Running: m1_fast_nn [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/m1_fast_nn. Total cached: 9
Processing variant: m1_optimized_v2/nt_bn128_col_bk128_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn128_col_bk128_tg128...
    Running: nt_bn128_col_bk128_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn128_col_bk128_tg128. Total cached: 4
Processing variant: mlx/baseline
  Running 11 uncached specs for mlx/baseline...
    Running: baseline [mlx] - M:1 N:73 K:64 | 11/114/11
  Saved results for mlx/baseline. Total cached: 11
Processing variant: mps/baseline
  Running 20 uncached specs for mps/baseline...
    Running: baseline [mps] - M:1 N:64 K:84 | 20/205/20
  Saved results for mps/baseline. Total cached: 20
Processing variant: m1_optimized_v2/nt_bn128_col_bk64_tg64
  Running 4 uncached specs for m1_optimized_v2/nt_bn128_col_bk64_tg64...
    Running: nt_bn128_col_bk64_tg64 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn128_col_bk64_tg64. Total cached: 4
Processing variant: mlx/baseline_nn
  Running 9 uncached specs for mlx/baseline_nn...
    Running: baseline_nn [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/baseline_nn. Total cached: 9
Processing variant: m1_optimized_v2/nt_bn128_col_bk64_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn128_col_bk64_tg128...
    Running: nt_bn128_col_bk64_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn128_col_bk64_tg128. Total cached: 4
Processing variant: m1_optimized_v2/nt_bn128_col_bt_bk64_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn128_col_bt_bk64_tg128...
    Running: nt_bn128_col_bt_bk64_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn128_col_bt_bk64_tg128. Total cached: 4
Processing variant: m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128...
    Running: nt_bn64_col_vec4_bk64_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128. Total cached: 4
Processing variant: m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128...
    Running: nt_bn128_col_vec4_bk64_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128. Total cached: 4
Processing variant: m1_optimized_v2/nt_bn128_col_bt_bk128_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn128_col_bt_bk128_tg128...
    Running: nt_bn128_col_bt_bk128_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn128_col_bt_bk128_tg128. Total cached: 0
Processing variant: mlx/m1_fast_tt
  No supported specs for mlx/m1_fast_tt.
Processing variant: m1_optimized_v2/nt_bn64_col_bk64_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn64_col_bk64_tg128...
    Running: nt_bn64_col_bk64_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn64_col_bk64_tg128. Total cached: 4
Processing variant: mlx/nn_wide
  Running 9 uncached specs for mlx/nn_wide...
    Running: nn_wide [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/nn_wide. Total cached: 9
Processing variant: mlx/bk64_tt
  No supported specs for mlx/bk64_tt.
Processing variant: m1_optimized_v2/nt_bn64_col_bk128_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn64_col_bk128_tg128...
    Running: nt_bn64_col_bk128_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn64_col_bk128_tg128. Total cached: 4
Processing variant: gemm_tiled/baseline
  Running 9 uncached specs for gemm_tiled/baseline...
    Running: baseline [gemm_tiled] - M:1 N:64 K:84 | 9/91/9
  Saved results for gemm_tiled/baseline. Total cached: 9
Processing variant: mlx/m1_fast_nt
  Running 11 uncached specs for mlx/m1_fast_nt...
    Running: m1_fast_nt [mlx] - M:1 N:73 K:64 | 11/114/11
  Saved results for mlx/m1_fast_nt. Total cached: 11
Processing variant: gemv/smalln
  No supported specs for gemv/smalln.
Processing variant: m1_optimized_v2/nt_bn64_col_bt_bk128_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn64_col_bt_bk128_tg128...
    Running: nt_bn64_col_bt_bk128_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn64_col_bt_bk128_tg128. Total cached: 4
Processing variant: m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128...
    Running: nt_bn64_col_vec4_bk128_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128. Total cached: 4
Processing variant: mlx/bk64_nt
  Running 11 uncached specs for mlx/bk64_nt...
    Running: bk64_nt [mlx] - M:1 N:73 K:64 | 11/114/11
  Saved results for mlx/bk64_nt. Total cached: 11
Processing variant: gemv/baseline
  Running 1 uncached specs for gemv/baseline...
    Running: baseline [gemv] - M:1 N:1152 K:896 | 1/1
  Saved results for gemv/baseline. Total cached: 1
Processing variant: mlx/bk64_nn
  Running 9 uncached specs for mlx/bk64_nn...
    Running: bk64_nn [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/bk64_nn. Total cached: 9
Processing variant: mlx/nn_fast
  Running 9 uncached specs for mlx/nn_fast...
    Running: nn_fast [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/nn_fast. Total cached: 9
Processing variant: m1_optimized_v2/nt_bn64_col_bt_bk64_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn64_col_bt_bk64_tg128...
    Running: nt_bn64_col_bt_bk64_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn64_col_bt_bk64_tg128. Total cached: 4
Processing variant: mlx/bk64_tn
  No supported specs for mlx/bk64_tn.
Processing variant: m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128
  Running 4 uncached specs for m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128...
    Running: nt_bn128_col_vec4_bk128_tg128 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128. Total cached: 4
Processing variant: m1_optimized_v2/nt_bn64_col_bk64_tg64
  Running 4 uncached specs for m1_optimized_v2/nt_bn64_col_bk64_tg64...
    Running: nt_bn64_col_bk64_tg64 [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn64_col_bk64_tg64. Total cached: 4
Processing variant: m1_optimized_v2/nt_bn64_col
  Running 4 uncached specs for m1_optimized_v2/nt_bn64_col...
    Running: nt_bn64_col [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn64_col. Total cached: 4
Processing variant: m1_optimized_v2/nt_bn128_col
  Running 4 uncached specs for m1_optimized_v2/nt_bn128_col...
    Running: nt_bn128_col [m1_optimized_v2] - M:1 N:151936 K:896 | 4/4
  Saved results for m1_optimized_v2/nt_bn128_col. Total cached: 4
Benchmark completed. Processed 176 total results with 504 failures.
Matmul benchmark summary (iterations=6)
Spec op=matmul | batch=1 | m=1 | n=9728 | k=896 | tA=0 | tB=1:
   - mlx/baseline: avg_gpu=0.484ms | avg_cpu=0.713ms [vs orig 0.325ms] (+119.37%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - mlx/bk64_nt: avg_gpu=0.557ms | avg_cpu=0.792ms [vs orig 0.325ms] (+143.63%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - mlx/m1_fast_nt: avg_gpu=0.313ms | avg_cpu=0.502ms [vs orig 0.325ms] (+54.56%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col: avg_gpu=0.343ms | avg_cpu=0.535ms [vs orig 0.325ms] (+64.64%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_bk128_tg128: avg_gpu=0.187ms | avg_cpu=0.37ms [vs orig 0.325ms] (+13.89%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg128: avg_gpu=0.19ms | avg_cpu=0.378ms [vs orig 0.325ms] (+16.33%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg64: avg_gpu=0.263ms | avg_cpu=0.466ms [vs orig 0.325ms] (+43.31%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_bt_bk64_tg128: avg_gpu=0.886ms | avg_cpu=1.127ms [vs orig 0.325ms] (+246.77%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_bt_bk64_tg64: avg_gpu=0.617ms | avg_cpu=0.795ms [vs orig 0.325ms] (+144.70%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128: avg_gpu=0.173ms | avg_cpu=0.369ms [vs orig 0.325ms] (+13.39%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128: avg_gpu=0.171ms | avg_cpu=0.357ms [vs orig 0.325ms] (+9.85%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col: avg_gpu=0.364ms | avg_cpu=0.56ms [vs orig 0.325ms] (+72.45%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_bk128_tg128: avg_gpu=0.174ms | avg_cpu=0.362ms [vs orig 0.325ms] (+11.32%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg128: avg_gpu=0.175ms | avg_cpu=0.332ms [vs orig 0.325ms] (+2.12%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg64: avg_gpu=0.186ms | avg_cpu=0.381ms [vs orig 0.325ms] (+17.19%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk128_tg128: avg_gpu=0.471ms | avg_cpu=0.697ms [vs orig 0.325ms] (+114.46%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk64_tg128: avg_gpu=0.58ms | avg_cpu=0.777ms [vs orig 0.325ms] (+139.01%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk64_tg64: avg_gpu=0.572ms | avg_cpu=0.811ms [vs orig 0.325ms] (+149.45%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128 [best-gpu] [best-cpu]: avg_gpu=0.142ms | avg_cpu=0.273ms [vs orig 0.325ms] (-15.89%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128: avg_gpu=0.164ms | avg_cpu=0.352ms [vs orig 0.325ms] (+8.40%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - mps/baseline [baseline]: avg_gpu=0.162ms | avg_cpu=0.402ms [vs orig 0.325ms] (+23.67%) maxAbs=1.5522e-02 maxRel=4.7867e-04
Spec op=matmul | batch=1 | m=1 | n=896 | k=4864 | tA=0 | tB=1:
   - mlx/baseline: avg_gpu=0.68ms | avg_cpu=1.079ms [vs orig 0.239ms] (+351.26%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - mlx/bk64_nt: avg_gpu=0.243ms | avg_cpu=0.465ms [vs orig 0.239ms] (+94.47%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - mlx/m1_fast_nt: avg_gpu=0.479ms | avg_cpu=0.716ms [vs orig 0.239ms] (+199.60%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col: avg_gpu=0.931ms | avg_cpu=1.194ms [vs orig 0.239ms] (+399.61%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_bk128_tg128: avg_gpu=0.236ms | avg_cpu=0.417ms [vs orig 0.239ms] (+74.60%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg128: avg_gpu=0.574ms | avg_cpu=0.795ms [vs orig 0.239ms] (+232.45%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg64: avg_gpu=0.451ms | avg_cpu=0.686ms [vs orig 0.239ms] (+186.88%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_bt_bk64_tg128: avg_gpu=0.871ms | avg_cpu=1.098ms [vs orig 0.239ms] (+359.26%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_bt_bk64_tg64: avg_gpu=1.467ms | avg_cpu=1.778ms [vs orig 0.239ms] (+643.99%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128: avg_gpu=0.395ms | avg_cpu=0.62ms [vs orig 0.239ms] (+159.21%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128: avg_gpu=0.416ms | avg_cpu=0.693ms [vs orig 0.239ms] (+189.97%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col: avg_gpu=0.612ms | avg_cpu=0.857ms [vs orig 0.239ms] (+258.48%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_bk128_tg128: avg_gpu=0.222ms | avg_cpu=0.398ms [vs orig 0.239ms] (+66.57%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg128: avg_gpu=0.584ms | avg_cpu=0.806ms [vs orig 0.239ms] (+237.33%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg64: avg_gpu=0.573ms | avg_cpu=0.811ms [vs orig 0.239ms] (+239.18%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk128_tg128: avg_gpu=0.787ms | avg_cpu=1.017ms [vs orig 0.239ms] (+325.33%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk64_tg128: avg_gpu=1.734ms | avg_cpu=2.091ms [vs orig 0.239ms] (+775.09%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk64_tg64: avg_gpu=0.796ms | avg_cpu=1.015ms [vs orig 0.239ms] (+324.84%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128: avg_gpu=0.365ms | avg_cpu=0.569ms [vs orig 0.239ms] (+138.00%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128: avg_gpu=0.435ms | avg_cpu=0.691ms [vs orig 0.239ms] (+188.92%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - mps/baseline [baseline] [best-gpu] [best-cpu]: avg_gpu=0.085ms | avg_cpu=0.276ms [vs orig 0.239ms] (+15.33%) maxAbs=2.8069e-02 maxRel=4.5125e-04
Spec op=matmul | batch=1 | m=1 | n=896 | k=896 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.128ms | avg_cpu=0.298ms [vs orig 0.235ms] (+26.72%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - mlx/bk64_nt: avg_gpu=0.036ms | avg_cpu=0.401ms [vs orig 0.235ms] (+70.60%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - mlx/m1_fast_nt: avg_gpu=0.093ms | avg_cpu=0.304ms [vs orig 0.235ms] (+29.17%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col: avg_gpu=0.276ms | avg_cpu=0.466ms [vs orig 0.235ms] (+98.20%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_bk128_tg128: avg_gpu=0.106ms | avg_cpu=0.325ms [vs orig 0.235ms] (+38.14%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg128: avg_gpu=0.115ms | avg_cpu=0.323ms [vs orig 0.235ms] (+37.44%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg64: avg_gpu=0.209ms | avg_cpu=0.398ms [vs orig 0.235ms] (+69.41%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_bt_bk64_tg128: avg_gpu=0.397ms | avg_cpu=0.64ms [vs orig 0.235ms] (+172.34%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_bt_bk64_tg64: avg_gpu=0.538ms | avg_cpu=0.786ms [vs orig 0.235ms] (+234.29%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128: avg_gpu=0.075ms | avg_cpu=0.273ms [vs orig 0.235ms] (+16.37%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128: avg_gpu=0.08ms | avg_cpu=0.269ms [vs orig 0.235ms] (+14.32%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col: avg_gpu=0.278ms | avg_cpu=0.414ms [vs orig 0.235ms] (+76.18%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_bk128_tg128: avg_gpu=0.108ms | avg_cpu=0.318ms [vs orig 0.235ms] (+35.52%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg128: avg_gpu=0.111ms | avg_cpu=0.339ms [vs orig 0.235ms] (+44.08%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg64: avg_gpu=0.112ms | avg_cpu=0.33ms [vs orig 0.235ms] (+40.30%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk128_tg128: avg_gpu=0.387ms | avg_cpu=0.543ms [vs orig 0.235ms] (+131.13%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk64_tg128: avg_gpu=0.397ms | avg_cpu=0.653ms [vs orig 0.235ms] (+177.92%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk64_tg64: avg_gpu=0.399ms | avg_cpu=0.607ms [vs orig 0.235ms] (+158.24%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128: avg_gpu=0.076ms | avg_cpu=0.238ms [vs orig 0.235ms] (+1.36%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128: avg_gpu=0.083ms | avg_cpu=0.245ms [vs orig 0.235ms] (+4.07%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - mps/baseline [best-gpu] [best-cpu]: avg_gpu=0.026ms | avg_cpu=0.234ms [vs orig 0.235ms] (-0.45%) maxAbs=8.7585e-03 maxRel=4.7132e-04
Spec op=matmul_bias_add | batch=1 | m=1 | n=1152 | k=896 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.138ms | avg_cpu=0.293ms [vs orig 0.234ms] (+25.30%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/bk64_nn: avg_gpu=0.103ms | avg_cpu=0.284ms [vs orig 0.234ms] (+21.37%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/m1_fast_nn: avg_gpu=0.088ms | avg_cpu=0.248ms [vs orig 0.234ms] (+6.14%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/nn_fast: avg_gpu=0.117ms | avg_cpu=0.288ms [vs orig 0.234ms] (+22.96%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/nn_wide: avg_gpu=0.125ms | avg_cpu=0.261ms [vs orig 0.234ms] (+11.37%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mps/baseline: avg_gpu=0.035ms | avg_cpu=0.2ms [vs orig 0.234ms] (-14.65%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - gemv/baseline: avg_gpu=0.349ms | avg_cpu=0.547ms [vs orig 0.234ms] (+133.59%) maxAbs=4.0346e+01 maxRel=1.9951e+00
   - gemm_tiled/baseline [best-gpu] [best-cpu]: avg_gpu=0.032ms | avg_cpu=0.165ms [vs orig 0.234ms] (-29.70%) maxAbs=3.6164e+01 maxRel=1.8316e+00
Spec op=matmul | batch=1 | m=1 | n=151936 | k=896 | tA=0 | tB=1:
   - mlx/baseline: avg_gpu=2.013ms | avg_cpu=2.225ms [vs orig 2.51ms] (-11.37%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - mlx/bk64_nt: avg_gpu=2.076ms | avg_cpu=2.281ms [vs orig 2.51ms] (-9.14%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - mlx/m1_fast_nt: avg_gpu=2.073ms | avg_cpu=2.293ms [vs orig 2.51ms] (-8.64%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col: avg_gpu=2.237ms | avg_cpu=2.452ms [vs orig 2.51ms] (-2.29%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_bk128_tg128: avg_gpu=2.098ms | avg_cpu=2.31ms [vs orig 2.51ms] (-7.97%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg128: avg_gpu=2.11ms | avg_cpu=2.332ms [vs orig 2.51ms] (-7.10%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_bk64_tg64: avg_gpu=2.242ms | avg_cpu=2.45ms [vs orig 2.51ms] (-2.38%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_bt_bk64_tg128: avg_gpu=2.454ms | avg_cpu=2.67ms [vs orig 2.51ms] (+6.39%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_bt_bk64_tg64: avg_gpu=3.52ms | avg_cpu=3.74ms [vs orig 2.51ms] (+49.01%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128: avg_gpu=2.057ms | avg_cpu=2.26ms [vs orig 2.51ms] (-9.95%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128: avg_gpu=2.059ms | avg_cpu=2.276ms [vs orig 2.51ms] (-9.34%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col: avg_gpu=2.023ms | avg_cpu=2.218ms [vs orig 2.51ms] (-11.64%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_bk128_tg128: avg_gpu=2.043ms | avg_cpu=2.243ms [vs orig 2.51ms] (-10.64%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg128: avg_gpu=2.026ms | avg_cpu=2.241ms [vs orig 2.51ms] (-10.70%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_bk64_tg64: avg_gpu=2.216ms | avg_cpu=2.433ms [vs orig 2.51ms] (-3.08%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk128_tg128: avg_gpu=3.438ms | avg_cpu=3.611ms [vs orig 2.51ms] (+43.88%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk64_tg128: avg_gpu=2.32ms | avg_cpu=2.544ms [vs orig 2.51ms] (+1.35%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_bt_bk64_tg64: avg_gpu=2.172ms | avg_cpu=2.61ms [vs orig 2.51ms] (+3.99%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128: avg_gpu=2.053ms | avg_cpu=2.262ms [vs orig 2.51ms] (-9.90%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128: avg_gpu=2.038ms | avg_cpu=2.254ms [vs orig 2.51ms] (-10.21%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - mps/baseline [baseline] [best-gpu] [best-cpu]: avg_gpu=1.961ms | avg_cpu=2.181ms [vs orig 2.51ms] (-13.11%) maxAbs=1.5606e-02 maxRel=4.8769e-04
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=95 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.036ms | avg_cpu=0.205ms [vs orig 0.25ms] (-18.16%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/bk64_nn: avg_gpu=0.03ms | avg_cpu=0.204ms [vs orig 0.25ms] (-18.34%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/m1_fast_nn: avg_gpu=0.042ms | avg_cpu=0.186ms [vs orig 0.25ms] (-25.44%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/nn_fast: avg_gpu=0.031ms | avg_cpu=0.202ms [vs orig 0.25ms] (-19.03%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/nn_wide: avg_gpu=0.041ms | avg_cpu=0.192ms [vs orig 0.25ms] (-23.07%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.369ms [vs orig 0.25ms] (+47.60%) maxAbs=1.2707e+01 maxRel=1.9899e+00
   - gemm_tiled/baseline [best-cpu]: avg_gpu=0.032ms | avg_cpu=0.18ms [vs orig 0.25ms] (-28.17%) maxAbs=1.2707e+01 maxRel=1.9899e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=16 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline] [host-gap]: avg_gpu=0.014ms | avg_cpu=0.183ms [vs orig 0.249ms] (-26.52%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/bk64_nn: avg_gpu=0.021ms | avg_cpu=0.186ms [vs orig 0.249ms] (-25.13%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/m1_fast_nn [best-cpu]: avg_gpu=0.027ms | avg_cpu=0.169ms [vs orig 0.249ms] (-32.08%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/nn_fast: avg_gpu=0.019ms | avg_cpu=0.186ms [vs orig 0.249ms] (-25.18%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/nn_wide: avg_gpu=0.023ms | avg_cpu=0.174ms [vs orig 0.249ms] (-30.07%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.332ms [vs orig 0.249ms] (+33.53%) maxAbs=5.3670e+00 maxRel=1.9424e+00
   - gemm_tiled/baseline: avg_gpu=0.034ms | avg_cpu=0.179ms [vs orig 0.249ms] (-28.12%) maxAbs=5.3670e+00 maxRel=1.9424e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=51 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.006ms | avg_cpu=0.289ms [vs orig 0.231ms] (+25.28%) maxAbs=1.2858e+01 maxRel=1.9744e+00
   - mlx/bk64_nt [best-cpu] [host-gap]: avg_gpu=0.006ms | avg_cpu=0.151ms [vs orig 0.231ms] (-34.75%) maxAbs=1.2858e+01 maxRel=1.9744e+00
   - mlx/m1_fast_nt [host-gap]: avg_gpu=0.007ms | avg_cpu=0.156ms [vs orig 0.231ms] (-32.58%) maxAbs=1.2858e+01 maxRel=1.9744e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.337ms [vs orig 0.231ms] (+45.80%) maxAbs=1.0837e+01 maxRel=1.9621e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=88 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.032ms | avg_cpu=0.222ms [vs orig 0.219ms] (+1.27%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/bk64_nn: avg_gpu=0.027ms | avg_cpu=0.203ms [vs orig 0.219ms] (-7.09%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/m1_fast_nn: avg_gpu=0.038ms | avg_cpu=0.202ms [vs orig 0.219ms] (-7.83%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/nn_fast [best-cpu]: avg_gpu=0.033ms | avg_cpu=0.199ms [vs orig 0.219ms] (-9.18%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/nn_wide: avg_gpu=0.038ms | avg_cpu=0.247ms [vs orig 0.219ms] (+12.83%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.348ms [vs orig 0.219ms] (+59.05%) maxAbs=1.0712e+01 maxRel=1.8953e+00
   - gemm_tiled/baseline: avg_gpu=0.034ms | avg_cpu=0.26ms [vs orig 0.219ms] (+18.67%) maxAbs=1.0712e+01 maxRel=1.8953e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=83 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.008ms | avg_cpu=0.382ms [vs orig 0.216ms] (+76.76%) maxAbs=1.0957e+01 maxRel=1.9983e+00
   - mlx/bk64_nt [best-cpu] [host-gap]: avg_gpu=0.006ms | avg_cpu=0.237ms [vs orig 0.216ms] (+9.50%) maxAbs=1.0957e+01 maxRel=1.9983e+00
   - mlx/m1_fast_nt: avg_gpu=0.008ms | avg_cpu=0.27ms [vs orig 0.216ms] (+24.84%) maxAbs=1.0957e+01 maxRel=1.9983e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.341ms [vs orig 0.216ms] (+57.96%) maxAbs=8.5818e+00 maxRel=1.9616e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=90 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.009ms | avg_cpu=0.395ms [vs orig 0.208ms] (+90.05%) maxAbs=1.2589e+01 maxRel=1.9927e+00
   - mlx/bk64_nt [best-cpu]: avg_gpu=0.006ms | avg_cpu=0.31ms [vs orig 0.208ms] (+49.26%) maxAbs=1.2589e+01 maxRel=1.9927e+00
   - mlx/m1_fast_nt: avg_gpu=0.009ms | avg_cpu=0.38ms [vs orig 0.208ms] (+82.60%) maxAbs=1.2589e+01 maxRel=1.9927e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.322ms [vs orig 0.208ms] (+54.59%) maxAbs=8.6755e+00 maxRel=1.9529e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=76 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline]: avg_gpu=0.008ms | avg_cpu=0.4ms [vs orig 0.208ms] (+92.43%) maxAbs=9.8521e+00 maxRel=1.9938e+00
   - mlx/bk64_nt: avg_gpu=0.009ms | avg_cpu=0.421ms [vs orig 0.208ms] (+102.44%) maxAbs=9.8521e+00 maxRel=1.9938e+00
   - mlx/m1_fast_nt: avg_gpu=0.008ms | avg_cpu=0.403ms [vs orig 0.208ms] (+93.70%) maxAbs=9.8521e+00 maxRel=1.9938e+00
   - mps/baseline [best-gpu] [best-cpu]: avg_gpu=0.004ms | avg_cpu=0.321ms [vs orig 0.208ms] (+54.29%) maxAbs=9.7824e+00 maxRel=1.8962e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=83 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.037ms | avg_cpu=0.384ms [vs orig 0.187ms] (+105.52%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/bk64_nn [best-cpu]: avg_gpu=0.025ms | avg_cpu=0.276ms [vs orig 0.187ms] (+47.49%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/m1_fast_nn: avg_gpu=0.039ms | avg_cpu=0.397ms [vs orig 0.187ms] (+112.34%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/nn_fast: avg_gpu=0.033ms | avg_cpu=0.38ms [vs orig 0.187ms] (+102.99%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/nn_wide: avg_gpu=0.038ms | avg_cpu=0.344ms [vs orig 0.187ms] (+84.18%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.325ms [vs orig 0.187ms] (+73.77%) maxAbs=1.0758e+01 maxRel=1.9301e+00
   - gemm_tiled/baseline: avg_gpu=0.032ms | avg_cpu=0.382ms [vs orig 0.187ms] (+104.08%) maxAbs=1.0758e+01 maxRel=1.9301e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=69 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.037ms | avg_cpu=0.381ms [vs orig 0.176ms] (+116.22%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/bk64_nn: avg_gpu=0.027ms | avg_cpu=0.181ms [vs orig 0.176ms] (+2.99%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/m1_fast_nn: avg_gpu=0.042ms | avg_cpu=0.379ms [vs orig 0.176ms] (+115.33%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/nn_fast: avg_gpu=0.029ms | avg_cpu=0.305ms [vs orig 0.176ms] (+73.04%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/nn_wide: avg_gpu=0.037ms | avg_cpu=0.381ms [vs orig 0.176ms] (+116.61%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mps/baseline [best-gpu] [best-cpu]: avg_gpu=0.004ms | avg_cpu=0.126ms [vs orig 0.176ms] (-28.57%) maxAbs=8.0584e+00 maxRel=1.8970e+00
   - gemm_tiled/baseline: avg_gpu=0.033ms | avg_cpu=0.333ms [vs orig 0.176ms] (+89.25%) maxAbs=9.2600e+00 maxRel=1.8970e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=80 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline] [best-cpu]: avg_gpu=0.007ms | avg_cpu=0.369ms [vs orig 0.176ms] (+109.52%) maxAbs=1.4338e+01 maxRel=1.9998e+00
   - mlx/bk64_nt: avg_gpu=0.008ms | avg_cpu=0.398ms [vs orig 0.176ms] (+125.99%) maxAbs=1.4338e+01 maxRel=1.9998e+00
   - mlx/m1_fast_nt: avg_gpu=0.011ms | avg_cpu=0.417ms [vs orig 0.176ms] (+137.03%) maxAbs=1.4338e+01 maxRel=1.9998e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.4ms [vs orig 0.176ms] (+127.07%) maxAbs=8.5940e+00 maxRel=1.9854e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=67 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline] [best-cpu] [host-gap]: avg_gpu=0.007ms | avg_cpu=0.126ms [vs orig 0.172ms] (-26.56%) maxAbs=1.1647e+01 maxRel=1.9918e+00
   - mlx/bk64_nt [host-gap]: avg_gpu=0.006ms | avg_cpu=0.165ms [vs orig 0.172ms] (-3.81%) maxAbs=1.1647e+01 maxRel=1.9918e+00
   - mlx/m1_fast_nt [host-gap]: avg_gpu=0.007ms | avg_cpu=0.157ms [vs orig 0.172ms] (-8.61%) maxAbs=1.1647e+01 maxRel=1.9918e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.395ms [vs orig 0.172ms] (+129.64%) maxAbs=7.8347e+00 maxRel=1.9760e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=67 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.033ms | avg_cpu=0.196ms [vs orig 0.172ms] (+14.15%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/bk64_nn [best-cpu]: avg_gpu=0.028ms | avg_cpu=0.187ms [vs orig 0.172ms] (+8.83%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/m1_fast_nn: avg_gpu=0.038ms | avg_cpu=0.201ms [vs orig 0.172ms] (+17.00%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/nn_fast: avg_gpu=0.028ms | avg_cpu=0.2ms [vs orig 0.172ms] (+16.11%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/nn_wide: avg_gpu=0.034ms | avg_cpu=0.198ms [vs orig 0.172ms] (+15.01%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mps/baseline [best-gpu]: avg_gpu=0.007ms | avg_cpu=0.345ms [vs orig 0.172ms] (+100.48%) maxAbs=8.9936e+00 maxRel=1.9166e+00
   - gemm_tiled/baseline: avg_gpu=0.034ms | avg_cpu=0.376ms [vs orig 0.172ms] (+118.56%) maxAbs=8.9936e+00 maxRel=1.9166e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=73 | k=64 | tA=0 | tB=1:
   - mlx/baseline [baseline] [best-cpu]: avg_gpu=0.008ms | avg_cpu=0.151ms [vs orig 0.172ms] (-12.25%) maxAbs=1.2113e+01 maxRel=1.9921e+00
   - mlx/bk64_nt [best-gpu]: avg_gpu=0.006ms | avg_cpu=0.156ms [vs orig 0.172ms] (-9.46%) maxAbs=1.2113e+01 maxRel=1.9921e+00
   - mlx/m1_fast_nt: avg_gpu=0.008ms | avg_cpu=0.158ms [vs orig 0.172ms] (-8.02%) maxAbs=1.2113e+01 maxRel=1.9921e+00
   - mps/baseline: avg_gpu=0.008ms | avg_cpu=0.31ms [vs orig 0.172ms] (+79.95%) maxAbs=9.4629e+00 maxRel=1.9091e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=68 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.031ms | avg_cpu=0.199ms [vs orig 0.169ms] (+17.73%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/bk64_nn: avg_gpu=0.027ms | avg_cpu=0.18ms [vs orig 0.169ms] (+6.24%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/m1_fast_nn: avg_gpu=0.038ms | avg_cpu=0.201ms [vs orig 0.169ms] (+19.16%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/nn_fast: avg_gpu=0.03ms | avg_cpu=0.198ms [vs orig 0.169ms] (+17.17%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/nn_wide: avg_gpu=0.037ms | avg_cpu=0.197ms [vs orig 0.169ms] (+16.47%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mps/baseline [best-gpu] [best-cpu]: avg_gpu=0.011ms | avg_cpu=0.166ms [vs orig 0.169ms] (-1.57%) maxAbs=9.2023e+00 maxRel=1.8125e+00
   - gemm_tiled/baseline: avg_gpu=0.032ms | avg_cpu=0.2ms [vs orig 0.169ms] (+18.17%) maxAbs=9.2023e+00 maxRel=1.8125e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=84 | tA=0 | tB=0:
   - mlx/baseline_nn [baseline]: avg_gpu=0.031ms | avg_cpu=0.368ms [vs orig 0.169ms] (+117.73%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/bk64_nn [best-cpu]: avg_gpu=0.024ms | avg_cpu=0.182ms [vs orig 0.169ms] (+7.85%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/m1_fast_nn: avg_gpu=0.036ms | avg_cpu=0.233ms [vs orig 0.169ms] (+37.63%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/nn_fast: avg_gpu=0.031ms | avg_cpu=0.364ms [vs orig 0.169ms] (+115.44%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/nn_wide: avg_gpu=0.037ms | avg_cpu=0.259ms [vs orig 0.169ms] (+53.35%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mps/baseline [best-gpu]: avg_gpu=0.013ms | avg_cpu=0.459ms [vs orig 0.169ms] (+171.80%) maxAbs=9.9824e+00 maxRel=1.9386e+00
   - gemm_tiled/baseline: avg_gpu=0.034ms | avg_cpu=0.358ms [vs orig 0.169ms] (+111.95%) maxAbs=9.9824e+00 maxRel=1.9386e+00

Variant failures:
 - mlx/baseline: matmul_alpha_beta skipped 8 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/baseline_nn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - mlx/bk64_nn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - mlx/bk64_nt: matmul_alpha_beta skipped 8 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/bk64_tn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/bk64_tt: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/m1_fast_nn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - mlx/m1_fast_nt: matmul_alpha_beta skipped 8 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/m1_fast_tn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/m1_fast_tt: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/nn_fast: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - mlx/nn_wide: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - m1_optimized_v2/nt_bn128_col: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn128_col_bk128_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn128_col_bk64_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn128_col_bk64_tg64: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn128_col_bt_bk128_tg128: matmul skipped 4 (Failed to create pipeline for m1_dot_product_v2_nt_bn128_col_bt_bk128_tg128: Error Domain=AGXMetalG15X_M1 Code=3 "Threadgroup memory size (33280) exceeds the maximum threadgroup memory allowed (32768)" UserInfo={NSLocalizedDescription=Threadgroup memory size (33280) exceeds the maximum threadgroup memory allowed (32768)}), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn128_col_bt_bk64_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn128_col_bt_bk64_tg64: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn128_col_vec4_bk128_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn128_col_vec4_bk64_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn64_col: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn64_col_bk128_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn64_col_bk64_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn64_col_bk64_tg64: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn64_col_bt_bk128_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn64_col_bt_bk64_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn64_col_bt_bk64_tg64: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn64_col_vec4_bk128_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - m1_optimized_v2/nt_bn64_col_vec4_bk64_tg128: matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - gemv/baseline: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported)
 - gemv/smalln: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - gemm_tiled/baseline: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
