rm -rf .build
❯ rm -rf .cache
❯ METAL_RUN=1 ./run_matmul_probes_enhanced.sh
Enhanced variants configuration available, enhanced Swift code will use it
Compiling m1_dot_product_v2.metal → m1_dot_product_v2.metallib
Compiling m1_dot_product.metal → m1_dot_product.metallib
/Volumes/2TB/test-burn/tools/metal_probes/matmul/m1_dot_product.metal:25:15: warning: unused variable 'M' [-Wunused-variable]
    const int M = 1;
              ^
1 warning generated.
Compiling optimized_mlx_bk64.metal → optimized_mlx_bk64.metallib
Compiling optimized_mlx_m1.metal → optimized_mlx_m1.metallib
Compiling optimized_mlx_nn.metal → optimized_mlx_nn.metallib
Compiling original_gemm_tiled.metal → original_gemm_tiled.metallib
/Volumes/2TB/test-burn/tools/metal_probes/matmul/original_gemm_tiled.metal:76:20: warning: unused variable 'simdgroups_m' [-Wunused-variable]
        const uint simdgroups_m = tile_m / simdgroup_m;
                   ^
1 warning generated.
Compiling original_gemv_smalln.metal → original_gemv_smalln.metallib
Compiling original_gemv.metal → original_gemv.metallib
Compiling original_mlx.metal → original_mlx.metallib
Enhanced matmul probe compilation succeeded.
Executing enhanced matmul probe harness...
Processing variant: mlx/bk64_tn
  No supported specs for mlx/bk64_tn.
Processing variant: mlx/baseline_nn
  Running 9 uncached specs for mlx/baseline_nn...
    Running: baseline_nn [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/baseline_nn. Total cached: 9
Processing variant: mlx/m1_fast_nt
  Running 11 uncached specs for mlx/m1_fast_nt...
    Running: m1_fast_nt [mlx] - M:1 N:73 K:64 | 11/114/11
  Saved results for mlx/m1_fast_nt. Total cached: 11
Processing variant: mlx/nn_fast
  Running 9 uncached specs for mlx/nn_fast...
    Running: nn_fast [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/nn_fast. Total cached: 9
Processing variant: gemv/baseline
  Running 1 uncached specs for gemv/baseline...
    Running: baseline [gemv] - M:1 N:1152 K:896 | 1/1
  Saved results for gemv/baseline. Total cached: 1
Processing variant: mlx/nn_wide
  Running 9 uncached specs for mlx/nn_wide...
    Running: nn_wide [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/nn_wide. Total cached: 9
Processing variant: gemv/smalln
  No supported specs for gemv/smalln.
Processing variant: mlx/m1_fast_nn
  Running 9 uncached specs for mlx/m1_fast_nn...
    Running: m1_fast_nn [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/m1_fast_nn. Total cached: 9
Processing variant: mlx/baseline
  Running 11 uncached specs for mlx/baseline...
    Running: baseline [mlx] - M:1 N:73 K:64 | 11/114/11
  Saved results for mlx/baseline. Total cached: 11
Processing variant: mps/baseline
  Running 20 uncached specs for mps/baseline...
    Running: baseline [mps] - M:1 N:64 K:84 | 20/205/20
  Saved results for mps/baseline. Total cached: 20
Processing variant: mlx/m1_fast_tt
  No supported specs for mlx/m1_fast_tt.
Processing variant: gemm_tiled/baseline
  Running 9 uncached specs for gemm_tiled/baseline...
    Running: baseline [gemm_tiled] - M:1 N:64 K:84 | 9/91/9
  Saved results for gemm_tiled/baseline. Total cached: 9
Processing variant: mlx/m1_fast_tn
  No supported specs for mlx/m1_fast_tn.
Processing variant: mlx/bk64_nt
  Running 11 uncached specs for mlx/bk64_nt...
    Running: bk64_nt [mlx] - M:1 N:73 K:64 | 11/114/11
  Saved results for mlx/bk64_nt. Total cached: 11
Processing variant: mlx/bk64_nn
  Running 9 uncached specs for mlx/bk64_nn...
    Running: bk64_nn [mlx] - M:1 N:64 K:84 | 9/91/9
  Saved results for mlx/bk64_nn. Total cached: 9
Processing variant: mlx/bk64_tt
  No supported specs for mlx/bk64_tt.
Benchmark completed. Processed 108 total results with 212 failures.
Matmul benchmark summary (iterations=6)
Spec op=matmul | batch=1 | m=1 | n=9728 | k=896 | tA=0 | tB=1:
  best_avg_cpu: mps/baseline = 0.363ms
  best_avg_gpu: mps/baseline = 0.16ms
   - mlx/baseline: avg_gpu=0.487ms | avg_cpu=0.98ms [vs orig 0.325ms] (+201.68%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - mlx/bk64_nt: avg_gpu=0.432ms | avg_cpu=0.669ms [vs orig 0.325ms] (+105.78%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - mlx/m1_fast_nt: avg_gpu=0.316ms | avg_cpu=0.456ms [vs orig 0.325ms] (+40.42%) maxAbs=1.5522e-02 maxRel=4.7867e-04
   - mps/baseline [baseline] [best-gpu]: avg_gpu=0.16ms | avg_cpu=0.363ms [vs orig 0.325ms] (+11.84%) maxAbs=1.5522e-02 maxRel=4.7867e-04
Spec op=matmul | batch=1 | m=1 | n=896 | k=4864 | tA=0 | tB=1:
  best_avg_cpu: mps/baseline = 0.244ms
  best_avg_gpu: mps/baseline = 0.086ms
   - mlx/baseline: avg_gpu=0.65ms | avg_cpu=0.914ms [vs orig 0.239ms] (+282.23%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - mlx/bk64_nt: avg_gpu=0.382ms | avg_cpu=0.582ms [vs orig 0.239ms] (+143.51%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - mlx/m1_fast_nt: avg_gpu=0.475ms | avg_cpu=0.71ms [vs orig 0.239ms] (+196.98%) maxAbs=2.8069e-02 maxRel=4.5125e-04
   - mps/baseline [baseline] [best-gpu]: avg_gpu=0.086ms | avg_cpu=0.244ms [vs orig 0.239ms] (+1.91%) maxAbs=2.8069e-02 maxRel=4.5125e-04
Spec op=matmul | batch=1 | m=1 | n=896 | k=896 | tA=0 | tB=1:
  best_avg_cpu: mlx/bk64_nt = 0.269ms
  best_avg_gpu: mps/baseline = 0.026ms
   - mlx/baseline [baseline]: avg_gpu=0.134ms | avg_cpu=0.335ms [vs orig 0.235ms] (+42.62%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - mlx/bk64_nt: avg_gpu=0.08ms | avg_cpu=0.269ms [vs orig 0.235ms] (+14.54%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - mlx/m1_fast_nt: avg_gpu=0.093ms | avg_cpu=0.307ms [vs orig 0.235ms] (+30.60%) maxAbs=8.7585e-03 maxRel=4.7132e-04
   - mps/baseline [best-gpu]: avg_gpu=0.026ms | avg_cpu=0.289ms [vs orig 0.235ms] (+22.88%) maxAbs=8.7585e-03 maxRel=4.7132e-04
Spec op=matmul_bias_add | batch=1 | m=1 | n=1152 | k=896 | tA=0 | tB=0:
  best_avg_cpu: gemm_tiled/baseline = 0.176ms
  best_avg_gpu: gemm_tiled/baseline = 0.011ms
   - mlx/baseline_nn [baseline]: avg_gpu=0.138ms | avg_cpu=0.452ms [vs orig 0.234ms] (+93.03%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/bk64_nn: avg_gpu=0.101ms | avg_cpu=0.283ms [vs orig 0.234ms] (+20.92%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/m1_fast_nn: avg_gpu=0.086ms | avg_cpu=0.268ms [vs orig 0.234ms] (+14.47%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/nn_fast: avg_gpu=0.119ms | avg_cpu=0.289ms [vs orig 0.234ms] (+23.59%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mlx/nn_wide: avg_gpu=0.123ms | avg_cpu=0.303ms [vs orig 0.234ms] (+29.51%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - mps/baseline: avg_gpu=0.034ms | avg_cpu=0.209ms [vs orig 0.234ms] (-10.59%) maxAbs=1.4099e-02 maxRel=4.7267e-04
   - gemv/baseline: avg_gpu=0.322ms | avg_cpu=0.502ms [vs orig 0.234ms] (+114.38%) maxAbs=2.1970e+03 maxRel=1.9864e+00
   - gemm_tiled/baseline [best-gpu]: avg_gpu=0.011ms | avg_cpu=0.176ms [vs orig 0.234ms] (-24.89%) maxAbs=3.6164e+01 maxRel=1.8316e+00
Spec op=matmul | batch=1 | m=1 | n=151936 | k=896 | tA=0 | tB=1:
  best_avg_cpu: mps/baseline = 2.184ms
  best_avg_gpu: mps/baseline = 1.957ms
   - mlx/baseline: avg_gpu=2.134ms | avg_cpu=2.343ms [vs orig 2.51ms] (-6.67%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - mlx/bk64_nt: avg_gpu=1.977ms | avg_cpu=2.199ms [vs orig 2.51ms] (-12.41%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - mlx/m1_fast_nt: avg_gpu=2.051ms | avg_cpu=2.253ms [vs orig 2.51ms] (-10.24%) maxAbs=1.5606e-02 maxRel=4.8769e-04
   - mps/baseline [baseline] [best-gpu]: avg_gpu=1.957ms | avg_cpu=2.184ms [vs orig 2.51ms] (-12.99%) maxAbs=1.5606e-02 maxRel=4.8769e-04
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=95 | tA=0 | tB=0:
  best_avg_cpu: gemm_tiled/baseline = 0.166ms
  best_avg_gpu: mps/baseline = 0.005ms
   - mlx/baseline_nn [baseline]: avg_gpu=0.036ms | avg_cpu=0.257ms [vs orig 0.25ms] (+2.93%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/bk64_nn: avg_gpu=0.028ms | avg_cpu=0.196ms [vs orig 0.25ms] (-21.67%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/m1_fast_nn: avg_gpu=0.039ms | avg_cpu=0.208ms [vs orig 0.25ms] (-16.80%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/nn_fast: avg_gpu=0.031ms | avg_cpu=0.2ms [vs orig 0.25ms] (-19.96%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mlx/nn_wide: avg_gpu=0.038ms | avg_cpu=0.207ms [vs orig 0.25ms] (-17.26%) maxAbs=1.9543e+01 maxRel=1.9976e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.354ms [vs orig 0.25ms] (+41.46%) maxAbs=1.2707e+01 maxRel=1.9899e+00
   - gemm_tiled/baseline: avg_gpu=0.009ms | avg_cpu=0.166ms [vs orig 0.25ms] (-33.79%) maxAbs=1.2707e+01 maxRel=1.9899e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=16 | tA=0 | tB=0:
  best_avg_cpu: mlx/baseline_nn = 0.146ms
  best_avg_gpu: mps/baseline = 0.006ms
   - mlx/baseline_nn [baseline]: avg_gpu=0.014ms | avg_cpu=0.146ms [vs orig 0.249ms] (-41.21%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/bk64_nn: avg_gpu=0.018ms | avg_cpu=0.185ms [vs orig 0.249ms] (-25.50%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/m1_fast_nn: avg_gpu=0.025ms | avg_cpu=0.19ms [vs orig 0.249ms] (-23.81%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/nn_fast: avg_gpu=0.017ms | avg_cpu=0.186ms [vs orig 0.249ms] (-25.50%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mlx/nn_wide: avg_gpu=0.021ms | avg_cpu=0.183ms [vs orig 0.249ms] (-26.32%) maxAbs=7.4595e+00 maxRel=1.9965e+00
   - mps/baseline [best-gpu]: avg_gpu=0.006ms | avg_cpu=0.153ms [vs orig 0.249ms] (-38.35%) maxAbs=5.3670e+00 maxRel=1.9424e+00
   - gemm_tiled/baseline: avg_gpu=0.01ms | avg_cpu=0.171ms [vs orig 0.249ms] (-31.26%) maxAbs=5.3670e+00 maxRel=1.9424e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=51 | k=64 | tA=0 | tB=1:
  best_avg_cpu: mlx/m1_fast_nt = 0.151ms
  best_avg_gpu: mps/baseline = 0.005ms
   - mlx/baseline [baseline]: avg_gpu=0.008ms | avg_cpu=0.362ms [vs orig 0.231ms] (+56.71%) maxAbs=1.2858e+01 maxRel=1.9744e+00
   - mlx/bk64_nt: avg_gpu=0.006ms | avg_cpu=0.357ms [vs orig 0.231ms] (+54.43%) maxAbs=3.1772e+03 maxRel=1.9744e+00
   - mlx/m1_fast_nt: avg_gpu=0.006ms | avg_cpu=0.151ms [vs orig 0.231ms] (-34.48%) maxAbs=1.2858e+01 maxRel=1.9744e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.352ms [vs orig 0.231ms] (+52.44%) maxAbs=1.0837e+01 maxRel=1.9621e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=88 | tA=0 | tB=0:
  best_avg_cpu: mlx/baseline_nn = 0.155ms
  best_avg_gpu: mps/baseline = 0.005ms
   - mlx/baseline_nn [baseline]: avg_gpu=0.037ms | avg_cpu=0.155ms [vs orig 0.219ms] (-29.43%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/bk64_nn: avg_gpu=0.026ms | avg_cpu=0.195ms [vs orig 0.219ms] (-10.83%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/m1_fast_nn: avg_gpu=0.041ms | avg_cpu=0.212ms [vs orig 0.219ms] (-3.10%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/nn_fast: avg_gpu=0.031ms | avg_cpu=0.197ms [vs orig 0.219ms] (-9.98%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mlx/nn_wide: avg_gpu=0.037ms | avg_cpu=0.206ms [vs orig 0.219ms] (-6.09%) maxAbs=1.6198e+01 maxRel=1.9972e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.351ms [vs orig 0.219ms] (+60.46%) maxAbs=1.0712e+01 maxRel=1.8953e+00
   - gemm_tiled/baseline: avg_gpu=0.009ms | avg_cpu=0.172ms [vs orig 0.219ms] (-21.36%) maxAbs=1.0712e+01 maxRel=1.8953e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=83 | k=64 | tA=0 | tB=1:
  best_avg_cpu: mps/baseline = 0.159ms
  best_avg_gpu: mps/baseline = 0.005ms
   - mlx/baseline [baseline]: avg_gpu=0.007ms | avg_cpu=0.409ms [vs orig 0.216ms] (+89.13%) maxAbs=1.0957e+01 maxRel=1.9983e+00
   - mlx/bk64_nt: avg_gpu=0.006ms | avg_cpu=0.398ms [vs orig 0.216ms] (+84.15%) maxAbs=1.0957e+01 maxRel=1.9983e+00
   - mlx/m1_fast_nt: avg_gpu=0.007ms | avg_cpu=0.2ms [vs orig 0.216ms] (-7.21%) maxAbs=1.0957e+01 maxRel=1.9983e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.159ms [vs orig 0.216ms] (-26.38%) maxAbs=8.5818e+00 maxRel=1.9616e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=90 | k=64 | tA=0 | tB=1:
  best_avg_cpu: mlx/baseline = 0.319ms
  best_avg_gpu: mps/baseline = 0.004ms
   - mlx/baseline [baseline]: avg_gpu=0.007ms | avg_cpu=0.319ms [vs orig 0.208ms] (+53.40%) maxAbs=1.2589e+01 maxRel=1.9927e+00
   - mlx/bk64_nt: avg_gpu=0.008ms | avg_cpu=0.417ms [vs orig 0.208ms] (+100.26%) maxAbs=1.2589e+01 maxRel=1.9927e+00
   - mlx/m1_fast_nt: avg_gpu=0.01ms | avg_cpu=0.413ms [vs orig 0.208ms] (+98.55%) maxAbs=1.2589e+01 maxRel=1.9927e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.375ms [vs orig 0.208ms] (+80.33%) maxAbs=8.6755e+00 maxRel=1.9529e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=76 | k=64 | tA=0 | tB=1:
  best_avg_cpu: mlx/bk64_nt = 0.259ms
  best_avg_gpu: mps/baseline = 0.004ms
   - mlx/baseline [baseline]: avg_gpu=0.007ms | avg_cpu=0.408ms [vs orig 0.208ms] (+96.36%) maxAbs=9.8521e+00 maxRel=1.9938e+00
   - mlx/bk64_nt: avg_gpu=0.007ms | avg_cpu=0.259ms [vs orig 0.208ms] (+24.56%) maxAbs=9.8521e+00 maxRel=1.9938e+00
   - mlx/m1_fast_nt: avg_gpu=0.009ms | avg_cpu=0.402ms [vs orig 0.208ms] (+93.27%) maxAbs=9.8521e+00 maxRel=1.9938e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.363ms [vs orig 0.208ms] (+74.45%) maxAbs=9.7824e+00 maxRel=1.8962e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=83 | tA=0 | tB=0:
  best_avg_cpu: mlx/baseline_nn = 0.143ms
  best_avg_gpu: mps/baseline = 0.004ms
   - mlx/baseline_nn [baseline]: avg_gpu=0.034ms | avg_cpu=0.143ms [vs orig 0.187ms] (-23.57%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/bk64_nn: avg_gpu=0.027ms | avg_cpu=0.268ms [vs orig 0.187ms] (+43.20%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/m1_fast_nn: avg_gpu=0.045ms | avg_cpu=0.209ms [vs orig 0.187ms] (+11.97%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/nn_fast: avg_gpu=0.029ms | avg_cpu=0.249ms [vs orig 0.187ms] (+33.09%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mlx/nn_wide: avg_gpu=0.035ms | avg_cpu=0.248ms [vs orig 0.187ms] (+32.70%) maxAbs=1.5927e+01 maxRel=1.9998e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.363ms [vs orig 0.187ms] (+93.90%) maxAbs=1.0758e+01 maxRel=1.9301e+00
   - gemm_tiled/baseline: avg_gpu=0.009ms | avg_cpu=0.18ms [vs orig 0.187ms] (-3.50%) maxAbs=1.0758e+01 maxRel=1.9301e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=69 | tA=0 | tB=0:
  best_avg_cpu: mlx/baseline_nn = 0.156ms
  best_avg_gpu: mps/baseline = 0.005ms
   - mlx/baseline_nn [baseline]: avg_gpu=0.039ms | avg_cpu=0.156ms [vs orig 0.176ms] (-11.28%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/bk64_nn: avg_gpu=0.025ms | avg_cpu=0.195ms [vs orig 0.176ms] (+10.56%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/m1_fast_nn: avg_gpu=0.039ms | avg_cpu=0.203ms [vs orig 0.176ms] (+15.23%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/nn_fast: avg_gpu=0.027ms | avg_cpu=0.196ms [vs orig 0.176ms] (+11.49%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mlx/nn_wide: avg_gpu=0.033ms | avg_cpu=0.203ms [vs orig 0.176ms] (+15.16%) maxAbs=1.2036e+01 maxRel=1.9803e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.369ms [vs orig 0.176ms] (+109.87%) maxAbs=8.0584e+00 maxRel=1.8970e+00
   - gemm_tiled/baseline: avg_gpu=0.008ms | avg_cpu=0.179ms [vs orig 0.176ms] (+1.74%) maxAbs=9.2600e+00 maxRel=1.8970e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=80 | k=64 | tA=0 | tB=1:
  best_avg_cpu: mlx/bk64_nt = 0.202ms
  best_avg_gpu: mps/baseline = 0.004ms
   - mlx/baseline [baseline]: avg_gpu=0.008ms | avg_cpu=0.404ms [vs orig 0.176ms] (+129.64%) maxAbs=1.4338e+01 maxRel=1.9998e+00
   - mlx/bk64_nt: avg_gpu=0.007ms | avg_cpu=0.202ms [vs orig 0.176ms] (+14.59%) maxAbs=1.4338e+01 maxRel=1.9998e+00
   - mlx/m1_fast_nt: avg_gpu=0.007ms | avg_cpu=0.411ms [vs orig 0.176ms] (+133.78%) maxAbs=1.4338e+01 maxRel=1.9998e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.372ms [vs orig 0.176ms] (+111.41%) maxAbs=8.5940e+00 maxRel=1.9854e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=67 | k=64 | tA=0 | tB=1:
  best_avg_cpu: mps/baseline = 0.155ms
  best_avg_gpu: mps/baseline = 0.004ms
   - mlx/baseline [baseline]: avg_gpu=0.007ms | avg_cpu=0.162ms [vs orig 0.172ms] (-5.56%) maxAbs=1.1647e+01 maxRel=1.9918e+00
   - mlx/bk64_nt: avg_gpu=0.006ms | avg_cpu=0.159ms [vs orig 0.172ms] (-7.46%) maxAbs=1.1647e+01 maxRel=1.9918e+00
   - mlx/m1_fast_nt: avg_gpu=0.009ms | avg_cpu=0.406ms [vs orig 0.172ms] (+136.09%) maxAbs=1.1647e+01 maxRel=1.9918e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.155ms [vs orig 0.172ms] (-10.17%) maxAbs=7.8347e+00 maxRel=1.9760e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=67 | tA=0 | tB=0:
  best_avg_cpu: mps/baseline = 0.152ms
  best_avg_gpu: mps/baseline = 0.004ms
   - mlx/baseline_nn [baseline]: avg_gpu=0.035ms | avg_cpu=0.298ms [vs orig 0.172ms] (+73.41%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/bk64_nn: avg_gpu=0.025ms | avg_cpu=0.193ms [vs orig 0.172ms] (+12.07%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/m1_fast_nn: avg_gpu=0.037ms | avg_cpu=0.208ms [vs orig 0.172ms] (+20.86%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/nn_fast: avg_gpu=0.028ms | avg_cpu=0.194ms [vs orig 0.172ms] (+13.05%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mlx/nn_wide: avg_gpu=0.033ms | avg_cpu=0.257ms [vs orig 0.172ms] (+49.39%) maxAbs=1.3197e+01 maxRel=1.9922e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.152ms [vs orig 0.172ms] (-11.68%) maxAbs=8.9936e+00 maxRel=1.9166e+00
   - gemm_tiled/baseline: avg_gpu=0.009ms | avg_cpu=0.251ms [vs orig 0.172ms] (+45.66%) maxAbs=8.9936e+00 maxRel=1.9166e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=73 | k=64 | tA=0 | tB=1:
  best_avg_cpu: mlx/bk64_nt = 0.156ms
  best_avg_gpu: mps/baseline = 0.004ms
   - mlx/baseline [baseline]: avg_gpu=0.006ms | avg_cpu=0.165ms [vs orig 0.172ms] (-4.09%) maxAbs=1.2113e+01 maxRel=1.9921e+00
   - mlx/bk64_nt: avg_gpu=0.006ms | avg_cpu=0.156ms [vs orig 0.172ms] (-9.14%) maxAbs=1.2113e+01 maxRel=1.9921e+00
   - mlx/m1_fast_nt: avg_gpu=0.008ms | avg_cpu=0.162ms [vs orig 0.172ms] (-5.93%) maxAbs=1.2113e+01 maxRel=1.9921e+00
   - mps/baseline [best-gpu]: avg_gpu=0.004ms | avg_cpu=0.327ms [vs orig 0.172ms] (+90.37%) maxAbs=9.4629e+00 maxRel=1.9091e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=68 | tA=0 | tB=0:
  best_avg_cpu: mps/baseline = 0.137ms
  best_avg_gpu: mps/baseline = 0.005ms
   - mlx/baseline_nn [baseline]: avg_gpu=0.037ms | avg_cpu=0.348ms [vs orig 0.169ms] (+106.16%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/bk64_nn: avg_gpu=0.026ms | avg_cpu=0.221ms [vs orig 0.169ms] (+30.67%) maxAbs=3.2834e+01 maxRel=1.9988e+00
   - mlx/m1_fast_nn: avg_gpu=0.04ms | avg_cpu=0.299ms [vs orig 0.169ms] (+76.98%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/nn_fast: avg_gpu=0.03ms | avg_cpu=0.385ms [vs orig 0.169ms] (+128.10%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mlx/nn_wide: avg_gpu=0.036ms | avg_cpu=0.353ms [vs orig 0.169ms] (+108.71%) maxAbs=1.3022e+01 maxRel=1.9988e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.137ms [vs orig 0.169ms] (-19.01%) maxAbs=9.2023e+00 maxRel=1.8125e+00
   - gemm_tiled/baseline: avg_gpu=0.01ms | avg_cpu=0.339ms [vs orig 0.169ms] (+100.67%) maxAbs=9.2023e+00 maxRel=1.8125e+00
Spec op=matmul_alpha_beta | batch=14 | m=1 | n=64 | k=84 | tA=0 | tB=0:
  best_avg_cpu: mlx/nn_wide = 0.194ms
  best_avg_gpu: mps/baseline = 0.005ms
   - mlx/baseline_nn [baseline]: avg_gpu=0.034ms | avg_cpu=0.357ms [vs orig 0.169ms] (+111.37%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/bk64_nn: avg_gpu=0.025ms | avg_cpu=0.358ms [vs orig 0.169ms] (+112.12%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/m1_fast_nn: avg_gpu=0.042ms | avg_cpu=0.216ms [vs orig 0.169ms] (+27.88%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/nn_fast: avg_gpu=0.028ms | avg_cpu=0.368ms [vs orig 0.169ms] (+117.60%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mlx/nn_wide: avg_gpu=0.037ms | avg_cpu=0.194ms [vs orig 0.169ms] (+15.01%) maxAbs=1.4888e+01 maxRel=1.9865e+00
   - mps/baseline [best-gpu]: avg_gpu=0.005ms | avg_cpu=0.312ms [vs orig 0.169ms] (+84.53%) maxAbs=9.9824e+00 maxRel=1.9386e+00
   - gemm_tiled/baseline: avg_gpu=0.012ms | avg_cpu=0.349ms [vs orig 0.169ms] (+106.70%) maxAbs=9.9824e+00 maxRel=1.9386e+00

Variant failures:
 - mlx/baseline: matmul_alpha_beta skipped 8 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/baseline_nn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - mlx/bk64_nn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - mlx/bk64_nt: matmul_alpha_beta skipped 8 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/bk64_tn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/bk64_tt: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/m1_fast_nn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - mlx/m1_fast_nt: matmul_alpha_beta skipped 8 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/m1_fast_tn: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/m1_fast_tt: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - mlx/nn_fast: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - mlx/nn_wide: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
 - gemv/baseline: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported)
 - gemv/smalln: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 15 (unsupported), matmul_bias_add skipped 1 (unsupported)
 - gemm_tiled/baseline: matmul skipped 4 (unsupported), matmul_alpha_beta skipped 7 (unsupported)
   (use --verbose-failures to list every skipped spec)